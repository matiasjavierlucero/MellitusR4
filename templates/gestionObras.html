{% extends 'layout.html' %} {% block title %} Gestionar Obras Sociales {% endblock %}
{% block body %}
{% if session['idTusu'] ==1 or session['idTusu'] ==3 %}
<div class="jm-loadingpage"></div>
<div class="containter m-auto text-center">
    <h2>Gesti√≥n de Prestadores</h2>
    <div class="row">
        <div class="col-xs-none col-sm-none col-md-none col-lg-2 "></div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-8">
            <div class="row justify-content-between">
                <div class="col">
                <input class="form-control w-100 mb-2" type="text" name="BuscarPaciente" id="FiltrarSecre"
                    placeholder="Puede ingresar cualquier parametro para acceder su busqueda">
                </div>
                    <div class="col">
                        <div class="btn btn-info w-auto"data-toggle="modal" data-target="#modalNuevoPrestador" >Nuevo Prestador</div>
                    </div>
                </div>
            <table class="table table-sm table-striped" id="tablaSecre">
                <thead>
                    <tr>
                        <th>Obra Social</th>
                        <th class="ocultarcol">Contacto Personal</th>
                        <th class="ocultarcol">Domicilio</th>
                        <th>Telefono</th>
                        <th>Estado</th>
                        <th>Ver</th>
                    </tr>
                </thead>
                <tbody>
                    {% for ob in obras %}
                    <tr>
                        <td>{{ob.1}}</td>
                        <td class="ocultarcol">{{ob.2}}</td>
                        <td class="ocultarcol">{{ob.4}}</td>
                        <td>{{ob.3}}</td>
                        <td class="estado{{ob.6}}">{{ob.5}}</td>
                        <td><a class="btn btn-info verPerfil" href="EditarObra{{ob.0}}">Editar</a></td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        <div class="col-xs-none col-sm-none col-md-none col-lg-2">
        </div>
    </div>
</div>


<div class="modal fade" id="modalNuevoPrestador" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
    aria-hidden="true">
    <div class="modal-dialog modal-md" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">Nuevo Prestador</h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="row form-group">
                    <label for="NombrePrestador">Nombre Prestador</label>
                    <input type="text" name="prestador" id="NombrePrestador" class="form-control inputform"
                        placeholder="Nombre Prestador" aria-describedby="helpId" required>
                    <label for="ContactoPrestador">Contacto</label>
                    <input type="text" name="prestador" id="ContactoPrestador" class="form-control inputform"
                        placeholder="Nombre del Contacto en el Prestador" aria-describedby="helpId">
                </div>
                <div class="row form-group">
                    <label for="TelefonoPrestador">Telefono Prestador</label>
                    <input type="phone" name="prestador" id="TelefonoPrestador" maxlength="10" class="form-control inputform"
                        placeholder="Codigo sin 0 + Numero sin 15 -Sin espacios- " aria-describedby="helpId" required>
                    <label for="EmailPrestador">Email Prestador</label>
                    <input type="email" name="prestador" id="EmailPrestador" class="form-control inputform"
                        placeholder="email@prestador.com" aria-describedby="helpId" required>
                </div>
                <div class="row form-group">
                    <label for="DireccionPrestador">Direccion Prestador</label>
                    <input type="text" name="prestador" id="DireccionPrestador" class="form-control inputform"
                        placeholder="Direccion y Numero" aria-describedby="helpId">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                <button type="button" class="btn btn-primary" id="guardarPrestador" disabled>Guardar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal de Alerta -->
<div class="modal fade" id="mensajedealerta" tabindex="-1" role="dialog" aria-labelledby="modelTitleId"
    aria-hidden="true" data-backdrop="static">
    <div class="mensajecolor modal-dialog modal-sm " role="document">
        <div class="modal-content bg-success">
            <div class="modal-body text-center">
                <i class="fa fa-check-circle" aria-hidden="true" style="font-size: 50px;color: white;"></i>
                <h3 id="confirmacionrecarga" style="color: white;"></h3>
                <h5 style="color: white;">Espere mientras se recarga su pagina</h5>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function () {
        $(".jm-loadingpage").fadeOut("slow");;
    });
</script>



<script>
$('.inputform').change(function(){
    suma=0
    $('.inputform').each(function () {
        valor=(($(this).val()))
        if (valor==''){
            suma--
        }else{
            suma++
        }
    })
    console.log(suma)
    if(suma>=5){
        $("#guardarPrestador").removeAttr('disabled').hmlt('Guardar')
    }if (suma < 5){
        $("#guardarPrestador").prop('disabled','disabled')
    }
})





    $(".estado0").html('Activo')
    $(".estado1").html('Inactivo')

    /* $(".verPerfil").click(function(){
        idSecre=$(this).attr("value")
        console.log(idSecre,estado)
    }) */

    $("#guardarPrestador").click(function () {
        $("#modalNuevoPrestador").modal('toggle')
            NombrePrestador = $("#NombrePrestador").val()
            ContactoPrestador = $("#ContactoPrestador").val()
            TelefonoPrestador = $("#TelefonoPrestador").val()
            EmailPrestador = $("#EmailPrestador").val()
            DireccionPrestador = $("#DireccionPrestador").val()

            $.ajax({
                url: 'NuevaObra',
                type: 'post',
                dataType: 'json',
                contentType: 'application/json',
                data: JSON.stringify([{
                    'NombrePrestador': NombrePrestador,
                    'ContactoPrestador': ContactoPrestador,
                    'TelefonoPrestador': TelefonoPrestador,
                    'EmailPrestador': EmailPrestador,
                    'DireccionPrestador': DireccionPrestador,
                }]),
                success: function (data) {
                    if (data.Mensaje == 'Correcto') {
                        $("#confirmacionrecarga").html('Obra Social cargada correctamente ')
                        $("#mensajedealerta").modal()
                        setTimeout(location.reload(true), 2000)
                    } if (data.Mensaje == 'Incorrecto') {
                        $("#modalGuardar").modal('toggle')
                        $("#coloralerta").removeClass('bg-success').addClass('bg-warning')
                        $("#confirmacionrecarga").html('La Obra Social Ya se encuentra Cargada ')
                        $("#mensajedealerta").removeAttr("data-backdrop")
                        $("#mensajerecarga").html('Presione fuera del mensaje para continuar')
                        $("#mensajedealerta").modal()

                    }
                }
            })
        })



</script>




<script>
    //BUSQUEDA DE PACIENTE---->TABLA DINAMICA
    //Para que la secretaria verifique un turno de un paciente sin necesidad de acceder al turnero
    $(document).ready(function () {
        $("#FiltrarSecre").on("keyup", function () {
            var value = $(this).val().toLowerCase();
            $("#tablaSecre tbody tr").filter(function () {
                $(this).toggle($(this).text().toLowerCase().indexOf(value) > -1)
            });
        });
    });
</script>


{% endif %}
{% endblock %}